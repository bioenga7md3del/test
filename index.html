<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Report - Spare Parts Settlement</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }

        /* تنسيق نموذج الإدخال */
        .input-container {
            background: white;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            direction: rtl; /* النموذج عربي لسهولة الإدخال */
        }

        .input-container h2 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .form-group label {
            width: 200px;
            font-weight: bold;
            color: #555;
        }

        .form-group input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .btn-print {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }

        .btn-print:hover {
            background-color: #218838;
        }

        /* تنسيق ورقة الطباعة (مخفية في الوضع العادي) */
        #print-view {
            display: none; /* مخفي افتراضياً */
            background: white;
            width: 210mm; /* A4 width */
            min-height: 297mm; /* A4 height */
            padding: 10mm;
            margin: 0 auto;
            color: black;
            font-family: Arial, sans-serif;
            box-sizing: border-box;
            direction: ltr; /* التقرير بالإنجليزي حسب الإكسل */
        }

        /* جداول التقرير */
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            font-size: 12px;
        }

        .report-table th, .report-table td {
            border: 1px solid black;
            padding: 4px 8px;
            text-align: left;
        }
        
        .no-border td {
            border: none;
        }

        .header-title {
            text-align: center;
            font-weight: bold;
            text-decoration: underline;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .signatures {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
        }

        .signature-box {
            width: 40%;
            text-align: center;
        }

        /* إعدادات الطباعة */
        @media print {
            body {
                background: white;
                margin: 0;
                padding: 0;
            }
            .input-container {
                display: none; /* إخفاء النموذج عند الطباعة */
            }
            #print-view {
                display: block; /* إظهار التقرير عند الطباعة */
                width: 100%;
                height: 100%;
                margin: 0;
                border: none;
            }
            @page {
                size: A4;
                margin: 0.5cm;
            }
        }
    </style>
</head>
<body>

    <div class="input-container">
        <h2>إدخال بيانات الفاتورة</h2>
        <div class="form-group"><label>Date:</label><input type="date" id="in_date"></div>
        <div class="form-group"><label>Division Name:</label><input type="text" id="in_division"></div>
        <div class="form-group"><label>Section Name:</label><input type="text" id="in_section"></div>
        <div class="form-group"><label>Project Name:</label><input type="text" id="in_project"></div>
        <div class="form-group"><label>Site Name:</label><input type="text" id="in_site"></div>
        <div class="form-group"><label>Vendor Name (Eng):</label><input type="text" id="in_vendor_eng"></div>
        <div class="form-group"><label>Vendor Name (Arab):</label><input type="text" id="in_vendor_arab"></div>
        
        <hr>
        <h3>بيانات الجدول</h3>
        <div class="form-group"><label>Site Ref.#:</label><input type="text" id="in_site_ref"></div>
        <div class="form-group"><label>FGC PO#:</label><input type="text" id="in_fgc_po"></div>
        <div class="form-group"><label>Invoice #:</label><input type="text" id="in_inv_num"></div>
        <div class="form-group"><label>Inv. Date:</label><input type="date" id="in_inv_date"></div>
        <div class="form-group"><label>Amount:</label><input type="number" step="0.01" id="in_amount" oninput="calculateTotal()"></div>
        <div class="form-group"><label>VAT:</label><input type="number" step="0.01" id="in_vat" oninput="calculateTotal()"></div>
        <div class="form-group"><label>Total Amount:</label><input type="text" id="in_total" readonly style="background:#eee;"></div>
        <div class="form-group"><label>In Word (SAR):</label><input type="text" id="in_words"></div>

        <hr>
        <div class="form-group"><label>Prepared By (Name):</label><input type="text" id="in_prepared"></div>

        <button class="btn-print" onclick="printReport()">معاينة وطباعة</button>
    </div>

    <div id="print-view">
        <div class="header-title">
            Technical Report<br>
            SPARE PARTS SETTLEMENT INVOICE
        </div>

        <table class="report-table no-border" style="width: 100%; margin-bottom: 20px;">
            <tr>
                <td style="width: 60%;"></td> <td style="width: 15%; font-weight: bold;">Date :</td>
                <td style="width: 25%; border-bottom: 1px solid #000;"><span id="out_date"></span></td>
            </tr>
            <tr>
                <td></td>
                <td style="font-weight: bold;">Division Name :</td>
                <td style="border-bottom: 1px solid #000;"><span id="out_division"></span></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">33</td> <td style="font-weight: bold;">Section Name :</td>
                <td style="border-bottom: 1px solid #000;"><span id="out_section"></span></td>
            </tr>
            <tr>
                <td></td>
                <td style="font-weight: bold;">Project Name :</td>
                <td style="border-bottom: 1px solid #000;"><span id="out_project"></span></td>
            </tr>
            <tr>
                <td></td>
                <td style="font-weight: bold;">Site Name :</td>
                <td style="border-bottom: 1px solid #000;"><span id="out_site"></span></td>
            </tr>
            <tr>
                <td colspan="3" style="padding-top: 10px;">Supporting Documentation Attached: <b>Serial No :</b> ________________</td>
            </tr>
        </table>

        <table class="report-table no-border">
            <tr>
                <td style="width: 20%; font-weight: bold;">Vendor/ Name Eng:</td>
                <td style="border-bottom: 1px solid #000;"><span id="out_vendor_eng"></span></td>
            </tr>
            <tr>
                <td style="font-weight: bold;">Vendor/ Name Arab:</td>
                <td style="border-bottom: 1px solid #000; text-align: right;"><span id="out_vendor_arab"></span></td>
            </tr>
        </table>
        <br>

        <table class="report-table" style="text-align: center;">
            <thead style="background-color: #f0f0f0;">
                <tr>
                    <th>S.N</th>
                    <th>Site Ref.#</th>
                    <th>FGC PO#</th>
                    <th>Invoice #</th>
                    <th>Inv. Date</th>
                    <th>Amount</th>
                    <th>VAT</th>
                    <th>Total Amount</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><span id="out_site_ref"></span></td>
                    <td><span id="out_fgc_po"></span></td>
                    <td><span id="out_inv_num"></span></td>
                    <td><span id="out_inv_date"></span></td>
                    <td><span id="out_amount"></span></td>
                    <td><span id="out_vat"></span></td>
                    <td><span id="out_total_row"></span></td>
                </tr>
                <tr>
                    <td colspan="7" style="text-align: right; font-weight: bold;">TOTAL AMOUNT</td>
                    <td style="font-weight: bold;"><span id="out_total_final"></span></td>
                </tr>
            </tbody>
        </table>

        <div style="margin: 10px 0;">
            <b>In Word (SAR):</b> <span id="out_words" style="text-decoration: underline;"></span>
        </div>

        <div style="margin: 20px 0; border: 1px solid #000; padding: 10px;">
            <b>The Report:</b><br>
            Material has been Requested by the site as per the purchase Order and work has to be done as per attachments from the site.
        </div>

        <div class="signatures">
            <div class="signature-box">
                <b>Prepared By:</b>
                <br><br><br>
                Name: <span id="out_prepared"></span>
            </div>
            <div class="signature-box">
                <b>Approved By:</b>
                <br><br><br>
                Name: <b>Mahmoud Sarhan</b><br>
                Medical Maintenance Projects Manager
            </div>
        </div>
    </div>

    <script>
        function calculateTotal() {
            const amount = parseFloat(document.getElementById('in_amount').value) || 0;
            const vat = parseFloat(document.getElementById('in_vat').value) || 0;
            const total = amount + vat;
            document.getElementById('in_total').value = total.toFixed(2);
        }

        function printReport() {
            // نقل البيانات من النموذج إلى التقرير
            document.getElementById('out_date').innerText = document.getElementById('in_date').value;
            document.getElementById('out_division').innerText = document.getElementById('in_division').value;
            document.getElementById('out_section').innerText = document.getElementById('in_section').value;
            document.getElementById('out_project').innerText = document.getElementById('in_project').value;
            document.getElementById('out_site').innerText = document.getElementById('in_site').value;
            
            document.getElementById('out_vendor_eng').innerText = document.getElementById('in_vendor_eng').value;
            document.getElementById('out_vendor_arab').innerText = document.getElementById('in_vendor_arab').value;
            
            document.getElementById('out_site_ref').innerText = document.getElementById('in_site_ref').value;
            document.getElementById('out_fgc_po').innerText = document.getElementById('in_fgc_po').value;
            document.getElementById('out_inv_num').innerText = document.getElementById('in_inv_num').value;
            document.getElementById('out_inv_date').innerText = document.getElementById('in_inv_date').value;
            
            // formatting numbers
            const amount = document.getElementById('in_amount').value;
            const vat = document.getElementById('in_vat').value;
            const total = document.getElementById('in_total').value;
            
            document.getElementById('out_amount').innerText = amount;
            document.getElementById('out_vat').innerText = vat;
            document.getElementById('out_total_row').innerText = total;
            document.getElementById('out_total_final').innerText = total;
            
            document.getElementById('out_words').innerText = document.getElementById('in_words').value;
            document.getElementById('out_prepared').innerText = document.getElementById('in_prepared').value;

            // أمر الطباعة
            window.print();
        }
    </script>
</body>
</html>
